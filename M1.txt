def create_table(slide, headers, num_rows, top_position, slide_width):
    cols = len(headers)
    table = slide.shapes.add_table(num_rows, cols, Inches(0.5), top_position, slide_width - Inches(1), Inches(0.5)).table

    # Set header row with green background and white font, and apply font size 10 to headers
    for col_idx, header in enumerate(headers):
        cell = table.cell(0, col_idx)
        cell.text = header
        cell.fill.solid()
        cell.fill.fore_color.rgb = RGBColor(0x48, 0x8F, 0x29)
        for paragraph in cell.text_frame.paragraphs:
            for run in paragraph.runs:
                run.font.size = Pt(10)
                run.font.bold = True
                run.font.color.rgb = RGBColor(255, 255, 255)

    # Apply borders to all cells in the table
    apply_full_border_to_table(table)

    return table



def apply_full_border_to_table(table):
    """
    Apply full borders to all cells in a PowerPoint table.
    """
    for row in table.rows:
        for cell in row.cells:
            tc = cell._tc  # Get the XML element for the cell
            tcPr = tc.get_or_add_tcPr()  # Get or add the <w:tcPr> element
            tcBorders = parse_xml(r'''
                <a:lnL w="12700">
                    <a:solidFill><a:srgbClr val="000000"/></a:solidFill>
                </a:lnL>
                <a:lnR w="12700">
                    <a:solidFill><a:srgbClr val="000000"/></a:solidFill>
                </a:lnR>
                <a:lnT w="12700">
                    <a:solidFill><a:srgbClr val="000000"/></a:solidFill>
                </a:lnT>
                <a:lnB w="12700">
                    <a:solidFill><a:srgbClr val="000000"/></a:solidFill>
                </a:lnB>
            ''')
            tcPr.append(tcBorders)



def populate_table(table, data, start_row=1):
    for row_idx, row_data in enumerate(data, start=start_row):
        for col_idx, cell_data in enumerate(row_data):
            cell = table.cell(row_idx, col_idx)
            cell.text = str(cell_data)
            cell.fill.solid()
            cell.fill.fore_color.rgb = RGBColor(255, 255, 255)  # White background for data cells
            for paragraph in cell.text_frame.paragraphs:
                for run in paragraph.runs:
                    run.font.size = Pt(10)
                    run.font.color.rgb = RGBColor(0, 0, 0)  # Black text
    apply_full_border_to_table(table)  # Re-apply borders just in case
