def merge_table_cells_ppt_clear_duplicates(table, col_indices):
    """
    Merge cells in the specified table columns if consecutive rows have identical values,
    and clear the content of the merged cells except the first cell in each group.

    Parameters:
    - table: The PowerPoint table object.
    - col_indices: A list of column indices to check for merging.
    """
    row_count = len(table.rows)

    for col_idx in col_indices:
        merge_start = 1  # Start from the first data row (skip header row)
        for row_idx in range(2, row_count):  # Start from the second data row
            current_cell = table.cell(row_idx, col_idx)
            previous_cell = table.cell(row_idx - 1, col_idx)

            # Check if the current and previous cells in this column have the same text
            if current_cell.text != previous_cell.text:
                # Merge the previous group of cells
                if merge_start < row_idx - 1:
                    merged_cell = table.cell(merge_start, col_idx).merge(table.cell(row_idx - 1, col_idx))
                    merged_cell.text = previous_cell.text  # Set the merged cell text
                    # Clear the content of all subsequent merged cells
                    for clear_idx in range(merge_start + 1, row_idx):
                        table.cell(clear_idx, col_idx).text = ""
                merge_start = row_idx  # Update the start of the next merge group

        # Handle the last group of cells
        if merge_start < row_count - 1:
            merged_cell = table.cell(merge_start, col_idx).merge(table.cell(row_count - 1, col_idx))
            merged_cell.text = table.cell(merge_start, col_idx).text  # Set the merged cell text
            # Clear the content of all subsequent merged cells
            for clear_idx in range(merge_start + 1, row_count):
                table.cell(clear_idx, col_idx).text = ""
