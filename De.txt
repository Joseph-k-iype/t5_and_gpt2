import json

# Load the JSON data (adjust the file path as needed)
with open("input.json", "r") as f:
    data = json.load(f)

for entry in data:
    regex_list = entry.get("classification_regex", [])
    if regex_list:
        # Join the individual regexes into a single alternation string
        alternatives = "|".join(regex_list)
        # Create a combined regex pattern that does two things:
        # 1. Matches a word exactly equal to one of the alternatives (using \b boundaries)
        # 2. Or matches a word that is at least 3 characters long and contains one of the alternatives anywhere
        combined_pattern = rf"(?i)(?:\b(?:{alternatives})\b|\b(?=\w{{3,}}\b)\w*(?:{alternatives})\w*\b)"
        entry["classification_regex"] = combined_pattern

# Write the updated data back to a JSON file
with open("output.json", "w") as f:
    json.dump(data, f, indent=4)

print("Updated JSON written to output.json")
