def merge_table_cells_ppt_clear_duplicates(table, col_indices):
    """
    Merge cells in specified table columns and ensure no repeated content in merged cells.

    Parameters:
    - table: The PowerPoint table object.
    - col_indices: List of column indices to check for merging.
    """
    row_count = len(table.rows)

    for col_idx in col_indices:
        merge_start = 1  # Start from the first data row (skip header row)
        last_text = None  # Track the last unique text

        for row_idx in range(1, row_count):  # Iterate through data rows
            current_cell = table.cell(row_idx, col_idx)

            # Skip if the cell is None (not valid)
            if current_cell is None:
                continue

            # Check if the current cell text matches the last unique text
            if current_cell.text == last_text:
                # Clear the current cell's text to avoid repetition
                current_cell.text = ""
            else:
                # Merge the previous group of cells, if applicable
                if merge_start < row_idx - 1:
                    table.cell(merge_start, col_idx).merge(table.cell(row_idx - 1, col_idx))

                # Update the start of the new merge group
                merge_start = row_idx
                last_text = current_cell.text  # Update the last unique text

        # Merge the last group in the column, if necessary
        if merge_start < row_count - 1:
            table.cell(merge_start, col_idx).merge(table.cell(row_count - 1, col_idx))
