from rdflib import Graph
import pandas as pd

# Load your RDF graph
g = Graph()
g.parse("your_file.rdf")  # or .ttl, .nt, etc.

# SPARQL query to get subject, predicate, object, and their classes
query = """
SELECT ?s ?p ?o ?s_class ?o_class WHERE {
  ?s ?p ?o .
  OPTIONAL { ?s a ?s_class . }
  OPTIONAL { ?o a ?o_class . }
  FILTER (isIRI(?s) && isIRI(?o))
}
"""

results = g.query(query)

# Convert results to DataFrame
df = pd.DataFrame(results.bindings)
df = df.rename(columns=lambda x: str(x))

# Extract value from rdflib.term.URIRef
df = df.applymap(lambda v: str(v) if v else None)
