prefix collibra: <http://collibra.com/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {
  # All triples in the subgraph
  ?s ?p ?o .
  
  # All type assertions
  ?s a ?type .
  ?o a ?otype .
  
  # Include schema information if available
  ?type rdfs:label ?typeLabel .
  ?p rdfs:label ?propLabel .
} where {
  # Start with reports (uncomment the FILTER line for a specific report)
  ?start a collibra:Report .
  # FILTER(?start = <http://example.com/your-specific-report-uri>)
  
  # Get all connected resources through multi-hop traversal
  {
    # Include the starting report itself
    BIND(?start as ?s)
  } UNION {
    # Direct connections from the report
    ?start ?p1 ?s .
    FILTER(isIRI(?s))
  } UNION {
    # Two-hop connections
    ?start ?p1 ?connected1 .
    FILTER(isIRI(?connected1))
    ?connected1 ?p2 ?s .
    FILTER(isIRI(?s))
  } UNION {
    # Three-hop connections
    ?start ?p1 ?connected1 .
    FILTER(isIRI(?connected1))
    ?connected1 ?p2 ?connected2 .
    FILTER(isIRI(?connected2))
    ?connected2 ?p3 ?s .
    FILTER(isIRI(?s))
  }
  
  # Get all properties of discovered subjects
  ?s ?p ?o .
  
  # Get all type information
  OPTIONAL { ?s a ?type }
  OPTIONAL { ?o a ?otype }
  
  # Get schema labels if available
  OPTIONAL { ?type rdfs:label ?typeLabel }
  OPTIONAL { ?p rdfs:label ?propLabel }
}
