# SPARQL Query to filter on subject and get full graph for related classes

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>

# Method 1: Get all triples involving classes that the filtered subject is related to
CONSTRUCT {
  ?class ?p1 ?o1 .
  ?s2 ?p2 ?class .
  ?s3 ?class ?o3 .
}
WHERE {
  # Replace with your specific subject URI
  VALUES ?targetSubject { <http://example.org/your-subject> }
  
  # Find all classes related to the target subject
  {
    # Direct type relationships
    ?targetSubject rdf:type ?class .
    FILTER(isURI(?class))
  }
  UNION
  {
    # Classes mentioned in object positions
    ?targetSubject ?anyProp ?class .
    ?class rdf:type owl:Class .
  }
  UNION
  {
    # Classes mentioned in subject positions pointing to our target
    ?class ?anyProp ?targetSubject .
    ?class rdf:type owl:Class .
  }
  UNION
  {
    # RDFS classes
    ?targetSubject ?anyProp ?class .
    ?class rdf:type rdfs:Class .
  }
  
  # Now get all triples involving these classes
  {
    # Class as subject
    ?class ?p1 ?o1 .
  }
  UNION
  {
    # Class as object
    ?s2 ?p2 ?class .
  }
  UNION
  {
    # Class as predicate (rare but possible)
    ?s3 ?class ?o3 .
  }
}

---

# Method 2: Alternative approach with more explicit class discovery
CONSTRUCT {
  ?s ?p ?o .
}
WHERE {
  # Replace with your specific subject URI
  VALUES ?targetSubject { <http://example.org/your-subject> }
  
  {
    # Get the classes of the target subject
    ?targetSubject rdf:type ?targetClass .
    
    # Get all triples involving instances of these classes
    {
      ?s rdf:type ?targetClass .
      ?s ?p ?o .
    }
    UNION
    {
      # Get class hierarchy and properties
      ?targetClass ?p ?o .
    }
    UNION
    {
      ?s ?p ?targetClass .
    }
  }
  UNION
  {
    # Get superclasses and their graphs
    ?targetSubject rdf:type ?directClass .
    ?directClass rdfs:subClassOf* ?superClass .
    
    {
      ?superClass ?p ?o .
    }
    UNION
    {
      ?s ?p ?superClass .
    }
    UNION
    {
      ?s rdf:type ?superClass .
      ?s ?p ?o .
    }
  }
}

---

# Method 3: Parameterized version with FILTER
SELECT ?s ?p ?o
WHERE {
  # Define your target subject here
  VALUES ?targetSubject { <http://example.org/your-subject> }
  
  # Find related classes
  {
    SELECT DISTINCT ?relatedClass WHERE {
      {
        ?targetSubject rdf:type ?relatedClass .
      }
      UNION
      {
        ?targetSubject ?prop ?relatedClass .
        ?relatedClass rdf:type ?classType .
        FILTER(?classType IN (owl:Class, rdfs:Class))
      }
      UNION
      {
        ?relatedClass ?prop ?targetSubject .
        ?relatedClass rdf:type ?classType .
        FILTER(?classType IN (owl:Class, rdfs:Class))
      }
    }
  }
  
  # Get all triples involving these classes
  ?s ?p ?o .
  FILTER(
    ?s IN (?relatedClass) || 
    ?p IN (?relatedClass) || 
    ?o IN (?relatedClass)
  )
}

---

# Method 4: Simple version focusing on direct class relationships
CONSTRUCT {
  ?s ?p ?o .
}
WHERE {
  VALUES ?targetSubject { <http://example.org/your-subject> }
  
  # Get the direct classes of the target subject
  ?targetSubject rdf:type ?class .
  
  # Get all information about these classes and their instances
  {
    # Class definition triples
    ?class ?p ?o .
  }
  UNION
  {
    # Triples pointing to the class
    ?s ?p ?class .
  }
  UNION
  {
    # All instances of the class and their properties
    ?s rdf:type ?class .
    ?s ?p ?o .
  }
}

---

# Usage Instructions:
# 1. Replace <http://example.org/your-subject> with your actual subject URI
# 2. Choose the method that best fits your needs:
#    - Method 1: Most comprehensive, includes indirect class relationships
#    - Method 2: Focuses on class hierarchies and inheritance
#    - Method 3: Uses SELECT for more control over results
#    - Method 4: Simple and direct, focuses on immediate class relationships
# 3. Adjust the prefixes according to your ontology
# 4. Add LIMIT clause if needed to manage result size
