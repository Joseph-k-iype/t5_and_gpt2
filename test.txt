from SPARQLWrapper import SPARQLWrapper, BASIC
from rdflib import Graph, ConjunctiveGraph
import rdflib.plugins.stores.sparqlstore as store

endpoint = "http://abc.com"
username = "your_username"
password = "your_password"

# Create a SPARQLWrapper instance for the endpoint
sparql = SPARQLWrapper(endpoint)
sparql.setCredentials(username, password)
sparql.setHTTPAuth(BASIC)

# Create a SPARQLUpdateStore and set the endpoint URL for both query and update
st = store.SPARQLUpdateStore(queryEndpoint=endpoint, update_endpoint=endpoint)

# Create the ConjunctiveGraph with the SPARQLUpdateStore
rdf = ConjunctiveGraph(store=st)

# Example query to get the number of statements
query = """
    SELECT (COUNT(?s) as ?count)
    WHERE {
        ?s ?p ?o.
    }
"""

# Execute the query using rdf.query()
results = rdf.query(query)

# Extract and print the count of statements
for row in results:
    print(f"Number of statements: {row['count']}")
