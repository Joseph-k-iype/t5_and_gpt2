import pandas as pd

# Create a sample DataFrame with string values
data = {
    'process': ['A', 'A', 'B', 'B', 'C', 'C'],
    'gcon': ['1', '1', '2', '2', '3', '3'],
    'gle': ['1', '0', '2', '2', '3', '3'],
    'glob': ['1', '1', '2', '1', '3', '3'],
    'pcdm': ['1', '1', '2', '2', '3', '0'],
    'ocdm': ['1', '1', '0', '2', '3', '3'],
    'ocon': ['1', '0', '2', '2', '3', '3'],
    'ole': ['1', '1', '2', '2', '3', '3'],
    'olob': ['1', '1', '2', '2', '0', '3']
}

df = pd.DataFrame(data)

# Define pairs for comparison
comparison_pairs = [('gcon', 'ocon'), ('gle', 'ole'), ('glob', 'olob'), ('pcdm', 'ocdm')]

def calculate_correctness(df, comparison_pairs):
    results = {}
    overall_correctness_list = []

    # Calculate correctness for each process
    for process in df['process'].unique():
        process_df = df[df['process'] == process].copy()
        
        # Create a correctness column for each pair
        for pair in comparison_pairs:
            process_df[f'{pair[0]}_{pair[1]}_correct'] = process_df.apply(lambda row: row[pair[0]] == row[pair[1]], axis=1)
        
        # Add a column that checks if all pairs are correct
        process_df['all_correct'] = process_df[[f'{pair[0]}_{pair[1]}_correct' for pair in comparison_pairs]].all(axis=1)
        
        # Calculate individual correctness for each pair
        individual_correctness = {}
        for pair in comparison_pairs:
            individual_correctness[f'{pair[0]}_{pair[1]}'] = process_df[f'{pair[0]}_{pair[1]}_correct'].mean() * 100
        
        # Calculate overall correctness for the process
        overall_correctness = process_df['all_correct'].mean() * 100
        overall_correctness_list.extend(process_df['all_correct'].tolist())
        
        # Extract examples
        fully_correct = process_df[process_df['all_correct'] == True]
        fully_wrong = process_df[process_df[[f'{pair[0]}_{pair[1]}_correct' for pair in comparison_pairs]].all(axis=1) == False]
        partially_correct = process_df[(process_df['all_correct'] == False) & (process_df[[f'{pair[0]}_{pair[1]}_correct' for pair in comparison_pairs]].any(axis=1))]
        
        results[process] = {
            'individual_correctness': individual_correctness,
            'overall_correctness': overall_correctness,
            'fully_correct': fully_correct,
            'partially_correct': partially_correct,
            'fully_wrong': fully_wrong
        }
    
    # Calculate overall correctness for the entire DataFrame
    overall_correctness_df = sum(overall_correctness_list) / len(overall_correctness_list) * 100
    
    return results, overall_correctness_df

results, overall_correctness_df = calculate_correctness(df, comparison_pairs)

# Prepare DataFrames to display results
individual_correctness_list = []
process_overall_correctness_list = []

for process, result in results.items():
    individual_correctness_list.append({'process': process, **result['individual_correctness']})
    process_overall_correctness_list.append({'process': process, 'overall_correctness': result['overall_correctness']})

individual_correctness_df = pd.DataFrame(individual_correctness_list)
process_overall_correctness_df = pd.DataFrame(process_overall_correctness_list)

print("Individual Correctness per Process:")
print(individual_correctness_df)

print("\nOverall Correctness per Process:")
print(process_overall_correctness_df)

print("\nOverall Correctness for the Entire DataFrame:")
print(f"{overall_correctness_df:.2f}%")

# Combine results for fully correct, partially correct, and fully wrong into a single DataFrame for each category
fully_correct_df = pd.concat([result['fully_correct'] for result in results.values()], ignore_index=True)
partially_correct_df = pd.concat([result['partially_correct'] for result in results.values()], ignore_index=True)
fully_wrong_df = pd.concat([result['fully_wrong'] for result in results.values()], ignore_index=True)

print("\nFully Correct Cases:")
print(fully_correct_df)

print("\nPartially Correct Cases:")
print(partially_correct_df)

print("\nFully Wrong Cases:")
print(fully_wrong_df)

