# With Sorting
# Sample DataFrame creation with string values
data = {
    'process': ['A', 'A', 'A', 'B', 'B', 'B', 'C', 'C', 'C'],
    'gcon': ['1', '1', '1', '0', '1', '1', '0', '1', '1'],
    'gle': ['1', '1', '0', '0', '1', '1', '0', '1', '0'],
    'glob': ['1', '1', '0', '0', '1', '0', '0', '1', '1'],
    'pcdm': ['1', '1', '1', '0', '1', '0', '0', '1', '1'],
    'ocdm': ['1', '1', '1', '0', '1', '0', '0', '1', '1'],
    'ocon': ['1', '1', '1', '0', '1', '0', '0', '1', '1'],
    'ole': ['1', '1', '1', '0', '1', '0', '0', '1', '1'],
    'olob': ['1', '1', '1', '0', '1', '0', '0', '1', '1']
}

df = pd.DataFrame(data)

# Define a function to check correctness and calculate percentages with sorting
def calculate_correctness_with_sorting(df):
    columns_to_check = ['gcon', 'gle', 'glob', 'pcdm', 'ocdm', 'ocon', 'ole', 'olob']
    
    # Sort values within each column
    for col in columns_to_check:
        df[col] = df[col].apply(lambda x: ''.join(sorted(x)) if isinstance(x, str) else x)
    
    df['correct_count'] = df[columns_to_check].eq(df[columns_to_check[0]], axis=0).sum(axis=1)
    df['correct_percentage'] = df['correct_count'] / len(columns_to_check) * 100
    
    overall_correctness = df['correct_percentage'].mean()
    individual_correctness = df[columns_to_check].eq(df[columns_to_check[0]], axis=0).mean() * 100
    
    fully_correct = df[df['correct_percentage'] == 100]
    partially_correct = df[(df['correct_percentage'] > 0) & (df['correct_percentage'] < 100)]
    fully_incorrect = df[df['correct_percentage'] == 0]
    
    return df, overall_correctness, individual_correctness, fully_correct, partially_correct, fully_incorrect

# Apply the function
df_sorted, overall_correctness_sorted, individual_correctness_sorted, fully_correct_sorted, partially_correct_sorted, fully_incorrect_sorted = calculate_correctness_with_sorting(df.copy())

import ace_tools as tools; tools.display_dataframe_to_user(name="Correctness DataFrame with Sorting", dataframe=df_sorted)

df_sorted, overall_correctness_sorted, individual_correctness_sorted, fully_correct_sorted, partially_correct_sorted, fully_incorrect_sorted
