from rdflib import Graph, ConjunctiveGraph
import rdflib.plugins.stores.sparqlstore as store

# Define the SPARQL endpoint and authentication details
endpoint = "https://abc.com/sparql"
auth_header = "Basic WWdjgflgnflngfgkhjbsdg"

# Create the SPARQL Update Store with authentication
st = store.SPARQLUpdateStore(
    queryEndpoint=endpoint,
    update_endpoint=endpoint,
    auth=(None, auth_header)
)

rdf = ConjunctiveGraph(store=st)

# Define your SPARQL query
query = """
PREFIX ex: <http://example.org/>
SELECT ?subject ?predicate ?object
WHERE {
  ?subject ?predicate ?object.
}
"""

# Execute the query
results = rdf.query(query)

# Print the number of statements
number_of_statements = len(results)
print(f"Number of statements: {number_of_statements}")
